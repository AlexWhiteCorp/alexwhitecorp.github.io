<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WatchDog</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="icon" href="favicon.png">

    <link rel="stylesheet" href="styles/common.css">
    <link rel="stylesheet" href="styles/header.css">
    <link rel="stylesheet" href="styles/nav.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.27.2/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.8.0/chart.min.js"></script>
</head>
<body>
<div class="header-wrapper">
    <div class="in-header">
        <img class="header-icon" src="favicon.png" alt="Logo">
        <div class="header-title">WatchDog</div>
    </div>
</div>
<div class="main-wrapper">
    <div class="in-main">
        <div class="nav-wrapper">
            <div class="nav-item"><a href="#about" class="nav-item-link">- About</a></div>
            <div class="nav-sub-item"><a href="#functionality" class="nav-item-link">- Functionality</a></div>
            <div class="nav-item"><a href="#download" class="nav-item-link">- Download</a></div>
            <div class="nav-item"><a href="#install" class="nav-item-link">- Install</a></div>
            <div class="nav-sub-item"><a href="#install-config" class="nav-item-link">- Configuration</a></div>
            <div class="nav-sub-item"><a href="#install-macos" class="nav-item-link">- MacOS</a></div>
            <div class="nav-sub-item"><a href="#install-windows" class="nav-item-link">- Windows 10</a></div>
            <div class="nav-sub-item"><a href="#install-custom-build" class="nav-item-link">- Custom build</a></div>
            <div class="nav-item"><a href="#access-token" class="nav-item-link">- Generate Access Token</a></div>
        </div>
        <div class="content-wrapper">
            <a name="about"></a>
            <div class="block">
                <div class="block-title">About</div>
                <div class="in-block flex-block">
                    <div>
                        <b>WatchDog</b> - tool for <b>GitHub</b> to keep <b>repositories</b>
                        you are interested in and their <b>pull requests</b> in <b>tray menu</b>.
                    </div>
                    <img class="default-img" style="max-width: 400px"
                         src="images/about-1.png" alt="NotFound">
                </div>
                <div class="in-block">
                    Thanks to this tool you will be able to:
                    <div class="in-block">
                        <div>- see all <b>your PRs</b> and PRs where <b>your review is request</b> in one place</div>
                        <div>- open needed repository or PR just in <b>two</b> clicks</div>
                    </div>
                </div>
                <div class="in-block">
                    WatchDog can be useful for you if:
                    <div class="in-block">
                        <div>- you are working in a big team</div>
                        <div>- you are working in several teams or organizations in same time</div>
                        <div>- project code consists of many repositories</div>
                        <div>- every day you receive a lot of PRs(some of them are long playing and it's hard to keep
                            attention)
                        </div>
                        <div>- you would like to open favorite(or needed for work) repositories in two clicks</div>
                    </div>
                </div>
            </div>

            <a name="functionality"></a>
            <div class="block">
                <div class="block-title">Functionality</div>
                <div class="in-block">
                    After you launch app you see app icon in <b>tray.</b>
                </div>
                <div class="in-block flex-block">
                    <div>On icon click will be opened pop up window with main menu.</div>
                    <img class="default-img" style="max-width: 400px"
                         src="images/functionality-1.png" alt="NotFound">
                </div>
                <div class="in-block">
                    Main menu contains <b>navigation panel</b> between organizations(you will provide in <a href="#install-config">config file</a>)
                    and list of repositories(also configurable) in this organization you are interested in.
                </div>
                <div class="in-block-title">Repositories</div>
                <div class="in-block flex-block">
                    <div>By clicking on repository name your open it's GitHub page in Browser.</div>
                </div>
                <div class="in-block flex-block">
                    <div>In case if there are opened Pull Requests in repository you see their number in this format:</div>
                    <i class="code-block">(approved PRs/total opened PRs in repository) repository-name</i>
                    <img class="default-img" style="max-width: 400px"
                         src="images/functionality-2.png" alt="NotFound">
                    <div><b>Notice:</b> PR is approved = at least one approval review</div>
                </div>
                <div class="in-block-title">Pull Requests</div>
                <div class="in-block flex-block">
                    <div>On mouse hover on repository name you see all opened PRs in this repository.</div>
                    <img class="default-img" style="max-width: 400px"
                         src="images/functionality-3.png" alt="NotFound">
                    <div>For each PR provides next info:</div>
                    <div class="in-block">
                        <div>- PR title and author</div>
                        <div>- number of approval requests</div>
                        <div>- PR author's comments/PR reviewers comments</div>
                        <div>- Time of last update</div>
                    </div>
                </div>
                <div class="in-block flex-block">
                    <div>By clicking on pull request card your open it's GitHub page in Browser.</div>
                </div>
                <div class="in-block">
                    If you have approved PR you will see '‚úì' near PR title
                    or 'üëÅ' if you leave at least one comment and haven't received answer yet(code review without approve)
                </div>
                <div class="in-block">
                    <div><b>Notice:</b> you don't see next PRs in this list:</div>
                    <div class="in-block">
                        <div>- drafts</div>
                        <div>- Bump Bot PRs</div>
                        <div>- you are not author or reviewer of pull request</div>
                    </div>
                </div>
                <div class="in-block-title">Refreshing and Icon color</div>
                <div class="in-block">Data is re-fetched <b>every 5 minutes</b> using GitHub API to keep information up to date.</div>
                <div class="in-block">
                    By default icon color is <b>black</b>.
                    But if there is at least one PR not approved(at least one approval review)
                    and you haven't reviewed it(or reviewed but already received answers from PR's author)
                    icon color will be changed to <b>blue</b>.
                    <div>So if you take a look on icon and it's blue - it means at least one PR needs your attention.</div>
                </div>
                <div class="in-block">
                    After all PRs become approved(or closed) icon color will be settled back to black.
                </div>
                <div class="in-block">
                    You can temporally pause/resume refreshing using button in the top right corner.
                    For example: on weekends to don't quit app at all.
                </div>

                <div class="in-block-title">New versions</div>
                <div class="in-block flex-block">
                   <div> On new version will be available you will receive notification
                       and special icon appear in the top left corner of main menu - click on it to open download page in browser</div>
                    <img class="default-img" style="max-width: 400px"
                         src="images/functionality-4.png" alt="NotFound">
                </div>
            </div>

            <a name="download"></a>
            <div class="block">
                <div class="block-title">Download</div>
                <div class="in-block">
                    <div> - <a class="download-mac-arm" href="">MacOS ARM</a></div>
                    <div> - <a class="download-mac64" href="">MacOS x64</a></div>
                    <div> - <a class="download-win64" href="">Windows x64</a></div>
                </div>
            </div>

            <a name="install"></a>
            <div class="block">
                <div class="block-title">Install</div>
            </div>

            <a name="install-config"></a>
            <div class="block">
                <div class="block-title">Configuration</div>
                <div class="in-block">
                    Before installation you need to prepare config file.
                    In this file you will fill in information about repositories you are interested in
                    and provide tokens for access to them.
                </div>
                <div class="in-block flex-block">
                    <div>In your home directory create <b>.watchdog</b> dir with <b>config.json</b> file inside it.</div>
                    <div>So final path will looks like: </div>
                    <i class="code-block">
                        ~/.watchdog/config.json
                    </i>
                </div>
                <div class="in-block flex-block">
                    <div>Fill in created config file using next schema(example): </div>
                    <textarea class="code-block" readonly="true">
{
  "organizations": [
    ...
    {
      "accessToken": "<access_token>",
      "organization": "AlexWhiteCorp",
      "groups": [
        {
          "repositories": [
            "alexwhitecorp.github.io",
            "watchdog"
          ]
        },
        {
          "repositories": [
            "my-repo-1",
            "my-repo-2",
            "my-repo-2"
          ],
          "fetchPRs": false, //Optional, by default is true.
                             //If false - repositories will be loaded but
                             //refreshing will be skipped for them
        },
        ...
      ]
    }
    ...
  ]
}</textarea>
                </div>
                <div class="in-block">
                    More info about <a href="#access-token">Access Token generation.</a>
                </div>
            </div>

            <a name="install-macos"></a>
            <div class="block">
                <div class="block-title">Install on MacOS</div>
                <div class="in-block flex-block">
                    <div>After you have downloaded and launched installer for your arch
                        (<a class="download-mac-arm" href="">MacOS ARM</a> or <a class="download-mac64" href="">MacOS
                            x64</a>)
                        move <b>WatchDog</b> app to <b>Applications</b> folder.
                    </div>
                    <img class="default-img" style="max-width: 400px"
                         src="images/install-macos-1.png" alt="NotFound">
                </div>
                <div class="in-block flex-block">
                    <div>If you try to run WatchDog app you will receive error message that image is damaged.
                        It actually means that author haven't bought Apple Developer Id yet and haven't sign this app.
                        So application is moved to quarantine.
                    </div>
                    <img class="default-img" style="max-width: 300px"
                         src="images/install-macos-2.png" alt="NotFound">
                </div>
                <div class="in-block flex-block">
                    <div>To solve this problem you just need to run next command in terminal:</div>
                    <i class="code-block">
                        xattr -d com.apple.quarantine /Applications/WatchDog.app
                    </i>
                </div>
                <div class="in-block flex-block">
                    <div>
                        If you try to run app now from <b>Applications</b> tab <s>it will successful opens</s>
                        you will see new security alert <i>"... app is from an unidentified developer..</i>." :)
                    </div>
                </div>
                <div class="in-block flex-block">
                    <div>To solve this problem:</div>
                    <div class="in-block">1. Open System Preferences</div>
                    <div class="in-block">2. Go to Security & Privacy and select the General tab</div>
                    <div class="in-block">3. If you‚Äôve been blocked from opening an app within the past hour,
                        this page will give you the option to override this by clicking the
                        temporary button ‚ÄòOpen Anyway‚Äô..
                    </div>
                    <div class="in-block">4. You‚Äôll be asked one more time if you‚Äôre sure, but clicking <b>Open</b> will
                        run the app
                    </div>
                    <img class="default-img" style="max-width: 500px"
                         src="images/install-macos-3.png" alt="NotFound">
                </div>
                <div class="in-block flex-block">
                    Happy end!
                </div>
                <div class="in-block flex-block">
                    <div>
                        Or you can try to go to <a href="#install-custom-build">Custom build</a> guide(<b>npm</b> and
                        <b>Node.js</b> are required).
                        If you generate app build on your machine you will avoid any security error message.
                    </div>
                </div>
            </div>

            <a name="install-windows"></a>
            <div class="block">
                <div class="block-title">Install on Windows 10</div>
                <div class="in-block flex-block">
                    <div>After you have downloaded and launched installer
                        (<a class="download-win64" href="">Windows x64</a>)
                        you will receive warning message:
                    </div>
                    <img class="default-img" style="max-width: 500px"
                         src="images/install-windows-1.png" alt="NotFound">
                </div>
                <div class="in-block">
                    It actually means that author haven't bought certificate yet and haven't sign this app.
                </div>
                <div class="in-block flex-block">
                    <div>Click <b>More info</b> and your will see <b>Run anyway</b> button.</div>
                    <img class="default-img" style="max-width: 450px"
                         src="images/install-windows-2.png" alt="NotFound">
                </div>
                <div class="in-block">
                    That's all :)
                </div>
            </div>

            <a name="install-custom-build"></a>
            <div class="block">
                <div class="block-title">Install using Custom Build</div>
                <div class="in-block">
                    You can try to generate custom build using project source code.
                    In this way you will avoid any security warning related to the lack of signature.
                    For this you need <b>npm</b> and <b>Node.js</b> installed.
                </div>
                <div class="in-block flex-block">
                    <div>Clone source code from project official repository:</div>
                    <i class="code-block">
                        git clone https://github.com/AlexWhiteCorp/watchdog.git
                    </i>
                </div>
                <div class="in-block flex-block">
                    <div>Move inside cloned directory and install needed dependencies</div>
                    <i class="code-block">
                        npm install
                    </i>
                </div>
                <div class="in-block flex-block">
                    <div>And finally generate you personal build:</div>
                    <i class="code-block">
                        npm run electron:build
                    </i>
                </div>
                <div class="in-block">
                    Electron-builder will automatically detect your OS/arch type and create install launcher.
                    You can find it in <b><i>dist_electron</i></b> folder. Final name depends on you OS, arch and app version:
                </div>
                <div class="in-block"><b>MacOS ARM: </b><i>dist_electron/WatchDog-{version}-arm64.dmg</i></div>
                <div class="in-block"><b>MacOS x64: </b><i>dist_electron/WatchDog-{version}.dmg</i></div>
                <div class="in-block"><b>Windows x64: </b><i>dist_electron/WatchDog Setup {version}.exe</i></div>
            </div>

            <a name="access-token"></a>
            <div class="block">
                <div class="block-title">How to generate GitHub Access Token</div>
                <div class="in-block">
                    Use this step-by-step
                    <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token"
                       target="_blank">GitHub Official Instruction</a>
                    to generate access token. <br>
                </div>
                <div class="in-block flex-block">
                    <div>Token should has next access scopes for correct work:</div>
                    <b class="in-block">- repo (all)</b>
                    <img class="default-img" style="max-width: 250px"
                         src="images/generate-token-1.png" alt="NotFound">
                    <b class="in-block">- admin:org (only read:org)</b>
                    <img class="default-img" style="max-width: 250px"
                         src="images/generate-token-2.png" alt="NotFound">
                </div>
                <div class="in-block flex-block">
                    <div>Don't forget to <b>Authorize SSO</b> (Single Sign-On) if it's enabled by your organization
                        (it's important!).
                    </div>
                    <img class="default-img" style="max-width: 400px"
                         src="images/generate-token-3.png" alt="NotFound">
                </div>
            </div>

            <a name="usage"></a>
            <div id="usage-statistic" class="block">
                <div class="block-title">Usage Statistic</div>
                <canvas id="chart-canvas"></canvas>
                <script>
                    if (document.location.hash !== '#usage') {
                        document.getElementById('usage-statistic').style.display = 'none'
                    }

                    const GIT_HUB_PATH = 'https://api.github.com'

                    function loadChart(data) {
                        const config = {
                            type: 'bar',
                            data: data,
                            options: {
                                plugins: {
                                    legend: {
                                        labels: {
                                            color: '#adbac7'
                                        }
                                    }
                                },
                                scales: {
                                    x: {
                                        ticks: {color: '#adbac7'}
                                    },
                                    y: {
                                        ticks: {color: '#adbac7', precision: 0}
                                    }
                                }
                            }
                        };

                        const chart = new Chart(
                            document.getElementById('chart-canvas'),
                            config
                        );
                    }

                    function serveChartData(labels, datasets) {
                        const common = {
                            maxBarThickness: 35,
                            categoryPercentage: 0.2,
                            barPercentage: 1.0
                        }

                        return {
                            labels: labels,
                            datasets: [
                                {
                                    label: 'Mac ARM',
                                    backgroundColor: '#ffb55a',
                                    borderColor: '#ffb55a',
                                    data: datasets[0],
                                    ...common
                                },
                                {
                                    label: 'Mac x64',
                                    backgroundColor: '#00bfa0',
                                    borderColor: '#00bfa0',
                                    data: datasets[1],
                                    ...common
                                },
                                {
                                    label: 'Windows x64',
                                    backgroundColor: '#0d88e6',
                                    borderColor: '#0d88e6',
                                    data: datasets[2],
                                    ...common
                                }
                            ]
                        };
                    }

                    axios.get(GIT_HUB_PATH + '/repos/AlexWhiteCorp/watchdog/releases')
                        .then(response => {
                            const labels = []
                            const datasets = [[], [], []]

                            response.data.forEach(release => {
                                const macArmAsset = release.assets.find(asset => asset.name.indexOf('arm64.dmg') !== -1)
                                const mac64Asset = release.assets.find(asset => asset.name.indexOf('.dmg') !== -1 && asset.name.indexOf('arm64.dmg') === -1)
                                const win64Asset = release.assets.find(asset => asset.name.indexOf('.exe') !== -1)

                                labels.push(release.tag_name)
                                datasets[0].push(macArmAsset.download_count)
                                datasets[1].push(mac64Asset.download_count)
                                datasets[2].push(win64Asset.download_count)
                            })

                            const data = serveChartData(labels, datasets)

                            loadChart(data)
                        })
                </script>
            </div>

            <script>
                axios.get('versions.json')
                    .then(response => {
                        const versions = response.data
                        let elements = document.getElementsByClassName('download-mac-arm')
                        for (const el of elements) {
                            el.href = versions['mac-arm'].download_url
                        }

                        elements = document.getElementsByClassName('download-mac64')
                        for (const el of elements) {
                            el.href = versions['mac64'].download_url
                        }

                        elements = document.getElementsByClassName('download-win64')
                        for (const el of elements) {
                            el.href = versions['win64'].download_url
                        }
                    })
            </script>
        </div>
    </div>
</div>
</body>
</html>